<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        وقت أذكار الصباح: من بعد صلاة الصبح إلى ما قبل طلوع الشمس.
        ووقت أذكار المساء: من بعد صلاة العصر إلى ما قبل الغروب، 
    </title>
    <style>
        :root {
            --primary: #1a5276;
            --secondary: #2e86c1;
            --accent: #f1c40f;
            --morning: #f39c12;
            --evening: #9b59b6;
            --light: #f8f9fa;
            --dark: #2c3e50;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 25px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        /* الهيدر */
        .header {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

            .header h1 {
                font-size: 2.2rem;
                margin-bottom: 10px;
            }

            .header .subtitle {
                opacity: 0.9;
                font-size: 1rem;
            }

        .time-indicator {
            position: absolute;
            left: 30px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--accent);
            color: var(--dark);
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 1.1rem;
        }

        /* التبويبات */
        .tabs {
            display: flex;
            background: var(--light);
            border-bottom: 2px solid #e0e0e0;
        }

        .tab-btn {
            flex: 1;
            padding: 20px;
            border: none;
            background: none;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

            .tab-btn.active {
                background: white;
            }

            .tab-btn[data-tab="morning"].active {
                color: var(--morning);
            }

            .tab-btn[data-tab="evening"].active {
                color: var(--evening);
            }

            .tab-btn.active::after {
                content: '';
                position: absolute;
                bottom: -2px;
                right: 0;
                width: 100%;
                height: 3px;
            }

            .tab-btn[data-tab="morning"].active::after {
                background: var(--morning);
            }

            .tab-btn[data-tab="evening"].active::after {
                background: var(--evening);
            }

        /* قائمة الأذكار */
        .azkar-list {
            padding: 30px;
            max-height: 600px;
            overflow-y: auto;
        }

        .zekr-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            border-right: 5px solid var(--secondary);
            transition: transform 0.3s, box-shadow 0.3s;
            position: relative;
        }

            .zekr-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 15px 30px rgba(0,0,0,0.1);
            }

            .zekr-card.completed {
                border-right-color: #2ecc71;
                background: #f8fff9;
            }

        .zekr-text {
            font-size: 1.4rem;
            line-height: 1.8;
            margin-bottom: 20px;
            color: var(--dark);
            font-weight: 500;
        }

        .zekr-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px dashed #e0e0e0;
        }

        .reference {
            color: var(--primary);
            font-size: 0.9rem;
            font-weight: bold;
        }

        .benefits {
            color: #27ae60;
            font-size: 0.9rem;
            background: #e8f6f3;
            padding: 10px 15px;
            border-radius: 10px;
            margin-top: 15px;
        }

        /* العداد */
        .counter {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .count-display {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            box-shadow: 0 8px 20px rgba(26, 82, 118, 0.3);
        }

        .count-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .count-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: var(--dark);
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

            .count-btn:hover {
                transform: scale(1.1);
            }

            .count-btn.plus {
                background: #2ecc71;
            }

            .count-btn.minus {
                background: #e74c3c;
            }

        .target-count {
            color: var(--primary);
            font-weight: bold;
            margin-right: 10px;
        }

        /* الإحصائيات */
        .stats-panel {
            background: var(--light);
            padding: 25px;
            border-radius: 20px;
            margin: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--secondary);
            margin-bottom: 10px;
        }

        .stat-label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        /* التذكير */
        .reminder {
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
            padding: 20px;
            border-radius: 15px;
            margin: 0 30px 30px;
            text-align: center;
            color: #d35400;
            font-weight: bold;
        }

        /* الإشعارات */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #2ecc71;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.3);
            display: none;
            z-index: 1000;
            animation: slideIn 0.3s;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* الفوتر */
        .footer {
            text-align: center;
            padding: 25px;
            background: var(--light);
            color: #7f8c8d;
            border-top: 1px solid #e0e0e0;
        }

        .share-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .share-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }

            .share-btn:hover {
                transform: translateY(-3px);
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            }

        /* التجاوب */
        @media (max-width: 768px) {
            .zekr-info {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }

            .counter {
                width: 100%;
                justify-content: space-between;
            }

            .header h1 {
                font-size: 1.8rem;
            }

            .time-indicator {
                position: static;
                transform: none;
                margin-top: 15px;
                display: inline-block;
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- الهيدر -->
        <div class="header">
            <div class="time-indicator" id="time-indicator">
                <span id="current-time"></span>
            </div>
            <h1>📖 أذكار الصباح والمساء</h1>
            <div class="subtitle">
                وقت أذكار الصباح: من بعد صلاة الصبح إلى ما قبل طلوع الشمس.
                ووقت أذكار المساء: من بعد صلاة العصر إلى ما قبل الغروب، 
            </div>
        </div>

        <!-- التبويبات -->
        <div class="tabs">
            <button class="tab-btn active" data-tab="morning">
                <i class="fas fa-sun"></i> أذكار الصباح
            </button>
            <button class="tab-btn" data-tab="evening">
                <i class="fas fa-moon"></i> أذكار المساء
            </button>
        </div>

        <!-- قائمة الأذكار -->
        <div class="azkar-list" id="azkar-list">
            <!-- سيتم ملؤها بالجافاسكريبت -->
        </div>

        <!-- الإحصائيات -->
        <div class="stats-panel">
            <div class="stat-item">
                <div class="stat-number" id="total-count">0</div>
                <div class="stat-label">مجموع الأذكار اليوم</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="completed-count">0</div>
                <div class="stat-label">مكتمل</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="remaining-count">0</div>
                <div class="stat-label">متبقي</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="streak-days">0</div>
                <div class="stat-label">يوم متتالي</div>
            </div>
        </div>

        <!-- التذكير -->
        <div class="reminder" id="reminder">
            <i class="fas fa-bell"></i>
            <span id="reminder-text">حان وقت أذكار الصباح! تذكر الله يذكرك</span>
        </div>

        <!-- الفوتر -->
        <div class="footer">
            <p>الَّذِينَ آمَنُوا وَتَطْمَئِنُّ قُلُوبُهُم بِذِكْرِ اللَّهِ ۗ أَلَا بِذِكْرِ اللَّهِ تَطْمَئِنُّ الْقُلُوبُ (28)</p>
            <div class="share-buttons">
                <button class="share-btn" id="share-app">
                    <i class="fas fa-share-alt"></i> شارك التطبيق
                </button>
                <button class="share-btn" id="print-btn">
                    <i class="fas fa-print"></i> طباعة الأذكار
                </button>
                <button class="share-btn" id="download-btn">
                    <i class="fas fa-download"></i> حفظ التقدم
                </button>
            </div>
            <p style="margin-top: 20px; font-size: 0.9rem;">
                تطبيق مجاني لخدمة المسلمين | يمكنك نسخه وتعديله ونشره
            </p>
        </div>
    </div>

    <!-- الإشعار -->
    <div class="notification" id="notification"></div>

    <script>
        // بيانات الأذكار (يمكن استيرادها من ملف JSON)
        const azkarData = {
            morning: [
                {
                    id: 1,
                    text: "أَعُوذُ بِاللَّهِ مِنَ الشَّيْطَانِ الرَّجِيمِ",
                    count: 1,
                    reference: "قبل قراءة القرآن",
                    benefits: "فَإِذَا قَرَأْتَ الْقُرْآنَ فَاسْتَعِذْ بِاللَّهِ مِنَ الشَّيْطَانِ الرَّجِيمِ - سورة النحل 98"
                },
                {
                    id: 2,
                    text: "اللَّهُ لَا إِلَهَ إِلَّا هُوَ الْحَيُّ الْقَيُّومُ لَا تَأْخُذُهُ سِنَةٌ وَلَا نَوْمٌ لَهُ مَا فِي السَّمَاوَاتِ وَمَا فِي الْأَرْضِ مَنْ ذَا الَّذِي يَشْفَعُ عِنْدَهُ إِلَّا بِإِذْنِهِ يَعْلَمُ مَا بَيْنَ أَيْدِيهِمْ وَمَا خَلْفَهُمْ وَلَا يُحِيطُونَ بِشَيْءٍ مِنْ عِلْمِهِ إِلَّا بِمَا شَاءَ وَسِعَ كُرْسِيُّهُ السَّمَاوَاتِ وَالْأَرْضَ وَلاَ يَؤُودُهُ حِفْظُهُمَا وَهُوَ الْعَلِيُّ الْعَظِيمُ",
                    count: 1,
                    reference: "آية الكرسي - البقرة 255",
                    benefits: "من قالها حين يصبح أجير من الجن حتى يمسي"
                },
                {
                    id: 3,
                    text: "بسم الله الرحمن الرحيم قُلۡ هُوَ ٱللَّهُ أَحَدٌ (1) ٱللَّهُ ٱلصَّمَدُ (2) لَمۡ يَلِدۡ وَلَمۡ يُولَدۡ (3) وَلَمۡ يَكُن لَّهُۥ كُفُوًا أَحَدُۢ (4)",
                    count: 3,
                    reference: "سورة الإخلاص",
                    benefits: "من قالها ثلاث مرات حين يصبح وحين يمسي كفته من كلِّ شيءٍ"
                },
                {
                    id: 4,
                    text: "بسم الله الرحمن الرحيم قُلۡ أَعُوذُ بِرَبِّ ٱلۡفَلَقِ (1) مِن شَرِّ مَا خَلَقَ (2) وَمِن شَرِّ غَاسِقٍ إِذَا وَقَبَ (3) وَمِن شَرِّ ٱلنَّفَّٰثَٰتِ فِي ٱلۡعُقَدِ (4) وَمِن شَرِّ حَاسِدٍ إِذَا حَسَدَ (5)",
                    count: 3,
                    reference: "سورة الفلق",
                    benefits: "من قالها ثلاث مرات حين يصبح وحين يمسي كفته من كلِّ شيءٍ"
                },
                {
                    id: 5,
                    text: "بسم الله الرحمن الرحيم قُلۡ أَعُوذُ بِرَبِّ ٱلنَّاسِ (1) مَلِكِ ٱلنَّاسِ (2) إِلَٰهِ ٱلنَّاسِ (3) مِن شَرِّ ٱلۡوَسۡوَاسِ ٱلۡخَنَّاسِ (4) ٱلَّذِي يُوَسۡوِسُ فِي صُدُورِ ٱلنَّاسِ (5) مِنَ ٱلۡجِنَّةِ وَٱلنَّاسِ (6)",
                    count: 3,
                    reference: "سورة الناس",
                    benefits: "من قالها ثلاث مرات حين يصبح وحين يمسي كفته من كلِّ شيءٍ"
                },
                {
                    id: 6,
                    text: "سُبْحَانَ اللَّهِ وَبِحَمْدِهِ",
                    count: 100,
                    reference: "البخاري ومسلم",
                    benefits: "حُطَّتْ خَطَايَاهُ وَإِنْ كَانَتْ مِثْلَ زَبَدِ الْبَحْرِ. لَمْ يَأْتِ أَحَدٌ يَوْمَ الْقِيَامَةِ بِأَفْضَلَ مِمَّا جَاءَ بِهِ إِلَّا أَحَدٌ قَالَ مِثْلَ مَا قَالَ أَوْ زَادَ عَلَيْهِ."
                },
                {
                    id: 7,
                    text: "أَصْـبَحْنا وَأَصْـبَحَ المُـلْكُ لله وَالحَمدُ لله ، لا إلهَ إلاّ اللّهُ وَحدَهُ لا شَريكَ لهُ، لهُ المُـلكُ ولهُ الحَمْـد، وهُوَ على كلّ شَيءٍ قدير ، رَبِّ أسْـأَلُـكَ خَـيرَ ما في هـذا اليوم وَخَـيرَ ما بَعْـدَه ، وَأَعـوذُ بِكَ مِنْ شَـرِّ ما في هـذا اليوم وَشَرِّ ما بَعْـدَه، رَبِّ أَعـوذُ بِكَ مِنَ الْكَسَـلِ وَسـوءِ الْكِـبَر ، رَبِّ أَعـوذُ بِكَ مِنْ عَـذابٍ في النّـارِ وَعَـذابٍ في القَـبْر",
                    count: 1,
                    reference: "صحيح مسلم",
                    
                },
                {
                    id: 8,
                    text: "اللّهـمَّ أَنْتَ رَبِّـي لا إلهَ إلاّ أَنْتَ ، خَلَقْتَنـي وَأَنا عَبْـدُك ، وَأَنا عَلـى عَهْـدِكَ وَوَعْـدِكَ ما اسْتَـطَعْـت ، أَعـوذُ بِكَ مِنْ شَـرِّ ما صَنَـعْت ، أَبـوءُ لَـكَ بِنِعْـمَتِـكَ عَلَـيَّ وَأَبـوءُ بِذَنْـبي فَاغْفـِرْ لي فَإِنَّـهُ لا يَغْـفِرُ الذُّنـوبَ إِلاّ أَنْتَ",
                    count: 1,
                    reference: "البخاري",
                    benefits: "مَن قالَها مِنَ النَّهارِ مُوقِنًا بها، فَماتَ مِن يَومِهِ قَبْلَ أنْ يُمْسِيَ، فَهو مِن أهْلِ الجَنَّةِ، ومَن قالَها مِنَ اللَّيْلِ وهو مُوقِنٌ بها، فَماتَ قَبْلَ أنْ يُصْبِحَ، فَهو مِن أهْلِ الجَنَّةِ."
                },
                {
                    id: 9,
                    text: "اللّهُـمَّ بِكَ أَصْـبَحْنا وَبِكَ أَمْسَـينا ، وَبِكَ نَحْـيا وَبِكَ نَمُـوتُ وَإِلَـيْكَ النُّـشُور",
                    count: 1,
                    reference: "الترمذي",
                    
                },
                {
                    id: 10,
                    text: "اللّهُـمَّ عالِـمَ الغَـيْبِ وَالشّـهادَةِ فاطِـرَ السّماواتِ وَالأرْضِ رَبَّ كـلِّ شَـيءٍ وَمَليـكَه ، أَشْهَـدُ أَنْ لا إِلـهَ إِلاّ أَنْت ، أَعـوذُ بِكَ مِن شَـرِّ نَفْسـي وَمِن شَـرِّ الشَّيْـطانِ وَشِرْكِهِ ، وَأَنْ أَقْتَـرِفَ عَلـى نَفْسـي سوءاً أَوْ أَجُـرَّهُ إِلـى مُسْـلِم",
                    count: 1,
                    reference: "الترمذي",
                },
                {
                    id: 11,
                    text: "بِسـمِ اللهِ الذي لا يَضُـرُّ مَعَ اسمِـهِ شَيءٌ في الأرْضِ وَلا في السّمـاءِ وَهـوَ السّمـيعُ العَلـيم",
                    count: 3,
                    reference: "صحيح أبي داود",
                    benefits: "من قالها ثلاثاً إذا أصبح, وثلاثاً إذا أمسى لم يضره شيء. "
                },
                {
                    id: 12,
                    text: "رَضيـتُ بِاللهِ رَبَّـاً وَبِالإسْلامِ ديـناً وَبِمُحَـمَّدٍ صلى الله عليه وسلم نَبِيّـاً",
                    count: 3,
                    reference: "الترمذي، وأبو داوود",
                    benefits: "من قالها ثلاثاً مرات حين يصبح وثلاثاً حين يمسي كان حقًا على الله أن يُرضِيَه"
                },
                {
                    id: 13,
                    text: "اللّهُـمَّ إِنِّـي أَصْبَـحْتُ أُشْـهِدُك ، وَأُشْـهِدُ حَمَلَـةَ عَـرْشِـك ، وَمَلَائِكَتَكَ ، وَجَمـيعَ خَلْـقِك ، أَنَّـكَ أَنْـتَ اللهُ لا إلهَ إلاّ أَنْـتَ وَحْـدَكَ لا شَريكَ لَـك ، وَأَنَّ  مُحَمّـداً عَبْـدُكَ وَرَسـولُـك",
                    count: 4,
                    reference: "أخرجه أبو داود",
                    benefits: "من قالها حين يصبح، أو يمسي أربعًا، أعتقَه اللهُ من النَّارِ  "
                },
                {
                    id: 14,
                    text: "اللّهُـمَّ ما أَصْبَـَحَ بي مِـنْ نِعْـمَةٍ أَو بِأَحَـدٍ مِـنْ خَلْـقِك ، فَمِـنْكَ وَحْـدَكَ لا شريكَ لَـك ، فَلَـكَ الْحَمْـدُ وَلَـكَ الشُّكْـر",
                    count: 1,
                    reference: "أخرجه أبو داود",
                    benefits: "مَن قالَ حينَ يُصبِحُ فقد أدَّى شُكرَ يومِه، ومن قالَ مثلَ ذلِك حينَ يُمسي، فقد أدَّى شُكرَ ليلتِه"
                },
                {
                    id: 15,
                    text: "اللّهُـمَّ إِنِّـي أسْـأَلُـكَ العَـفْوَ وَالعـافِـيةَ في الدُّنْـيا وَالآخِـرَة ، اللّهُـمَّ إِنِّـي أسْـأَلُـكَ العَـفْوَ وَالعـافِـيةَ في ديني وَدُنْـيايَ وَأهْـلي وَمالـي ، اللّهُـمَّ اسْتُـرْ عـوْراتي وَآمِـنْ رَوْعاتـي ، اللّهُـمَّ احْفَظْـني مِن بَـينِ يَدَيَّ وَمِن خَلْفـي وَعَن يَمـيني وَعَن شِمـالي ، وَمِن فَوْقـي ، وَأَعـوذُ بِعَظَمَـتِكَ أَن أُغْـتالَ مِن تَحْتـي",
                    count: 1,
                    reference: "أخرجه أبو داود",
                    
                },
                {
                    id: 16,
                    text: "لَا إلَه إلّا اللهُ وَحْدَهُ لَا شَرِيكَ لَهُ، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ وَهُوَ عَلَى كُلِّ شَيْءِ قَدِيرٌ",
                    count: 10,
                    reference: "البخاري ومسلم",
                    benefits: "من قالها عَشْرَ مِرَارٍ كانَ كَمَن أَعْتَقَ أَرْبَعَةَ أَنْفُسٍ مِن وَلَدِ إسْمَاعِيلَ"
                },
                {
                    id: 17,
                    text: "أَعـوذُ بِكَلِمـاتِ اللّهِ التّـامّـاتِ مِنْ شَـرِّ ما خَلَـق",
                    count: 3,
                    reference: "أخرجه مسلم",
                    benefits: "من قالها حين يصبحُ ثلاثَ مراتٍ لم تضرهُ عقربٌ حتى يمسِي ، ومن قالها حينَ يمسي لم تضرُّه حتى يصبحَ "
                },
                {
                    id: 18,
                    text: "أَصْبَـحْـنا عَلَى فِطْرَةِ الإسْلاَمِ، وَعَلَى كَلِمَةِ الإِخْلاَصِ، وَعَلَى دِينِ نَبِيِّنَا مُحَمَّدٍ صَلَّى اللهُ عَلَيْهِ وَسَلَّمَ، وَعَلَى مِلَّةِ أَبِينَا إبْرَاهِيمَ حَنِيفاً مُسْلِماً وَمَا كَانَ مِنَ المُشْرِكِينَ",
                    count: 1,
                    reference: "رواه أحمد",
                    
                },
                {
                    id: 19,
                    text: "اللّهُـمَّ عافِـني في بَدَنـي ، اللّهُـمَّ عافِـني في سَمْـعي ، اللّهُـمَّ عافِـني في بَصَـري ، لا إلهَ إلاّ أَنْـتَ . اللّهُـمَّ إِنّـي أَعـوذُ بِكَ مِنَ الْكُـفر ، وَالفَـقْر ، وَأَعـوذُ بِكَ مِنْ عَذابِ القَـبْر ، لا إلهَ إلاّ أَنْـتَ",
                    count: 3,
                    reference: "صحيح أبي داود",
                    
                },
                {
                    id: 20,
                    text: "لَا إلَه إلّا اللهُ وَحْدَهُ لَا شَرِيكَ لَهُ، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ وَهُوَ عَلَى كُلِّ شَيْءِ قَدِيرٌ",
                    count: 100,
                    reference: "البخاري ومسلم",
                    benefits: "كانت له عدل عشر رقاب، وكتبت له مئة حسنة، ومحيت عنه مئة سيئة"
                },
                {
                    id: 21,
                    text: "حَسْبِـيَ اللّهُ لا إلهَ إلاّ هُوَ عَلَـيهِ تَوَكَّـلتُ وَهُوَ رَبُّ العَرْشِ العَظـيم",
                    count: 7,
                    reference: "رواه ابن السني مرفوعاً وأبو داود موقوفاً",
                    benefits: "من قالها إذا أصبح وإذا أمسَى سبعَ مراتٍ كفاه اللهُ ما أهمَّه من أمر الدنيا والآخرة "
                },
                {
                    id: 22,
                    text: "يَا حَيُّ يَا قيُّومُ بِرَحْمَتِكَ أسْتَغِيثُ أصْلِحْ لِي شَأنِي كُلَّهُ وَلاَ تَكِلْنِي إلَى نَفْسِي طَـرْفَةَ عَيْنٍ",
                    count: 1,
                    reference: "صحيح الترغيب ",
                    
                },
                {
                    id: 23,
                    text: "أَصْبَـحْـنا وَأَصْبَـحْ المُـلكُ للهِ رَبِّ العـالَمـين ، اللّهُـمَّ إِنِّـي أسْـأَلُـكَ خَـيْرَ هـذا الـيَوْم ، فَـتْحَهُ ، وَنَصْـرَهُ ، وَنـورَهُ وَبَـرَكَتَـهُ ، وَهُـداهُ ، وَأَعـوذُ بِـكَ مِـنْ شَـرِّ ما فـيهِ وَشَـرِّ ما بَعْـدَه",
                    count: 1,
                    reference: "أبو داود",
                    
                },
                {
                    id: 24,
                    text: "سُبْحـانَ اللهِ وَبِحَمْـدِهِ عَدَدَ خَلْـقِه ، وَرِضـا نَفْسِـه ، وَزِنَـةَ عَـرْشِـه ، وَمِـدادَ كَلِمـاتِـه",
                    count: 3,
                    reference: "مسلم",
                    
                },
                {
                    id: 25,
                    text: "اللَّهُمَّ إِنِّي أَسْأَلُكَ عِلْمًا نَافِعًا ، وَرِزْقًا طَيِّبًا، وَعَمَلًا مُتَقَبَّلًا",
                    count: 3,
                    reference: "صحيح ابن ماجه",
                   
                },
                {
                    id: 26,
                    text: "أسْتَغْفِرُ اللهَ وَأتُوبُ إلَيْهِ",
                    count: 100,
                    reference: "البخاري ومسلم",
                    
                },
                {
                    id: 27,
                    text: "اللَّهُمَّ صَلِّ وَسَلِّمْ على نَبِيِّنَا مُحمَّد",
                    count: 10,
                    reference: " أخرجه الطبراني كما في ((الترغيب والترهيب))",
                    benefits: "من صلَّى عليَّ حينَ يصبحُ عشرًا وحينَ يمسي عشرًا أدرَكتْهُ شفاعتي يومَ القيامةِ"
                },

                
            ],
            evening: [
                {
                    id: 1,
                    text: "أَعُوذُ بِاللَّهِ مِنَ الشَّيْطَانِ الرَّجِيمِ",
                    count: 1,
                    reference: "قبل قراءة القرآن",
                    benefits: "فَإِذَا قَرَأْتَ الْقُرْآنَ فَاسْتَعِذْ بِاللَّهِ مِنَ الشَّيْطَانِ الرَّجِيمِ - سورة النحل 98"
                },
                {
                    id: 2,
                    text: "اللَّهُ لَا إِلَهَ إِلَّا هُوَ الْحَيُّ الْقَيُّومُ لَا تَأْخُذُهُ سِنَةٌ وَلَا نَوْمٌ لَهُ مَا فِي السَّمَاوَاتِ وَمَا فِي الْأَرْضِ مَنْ ذَا الَّذِي يَشْفَعُ عِنْدَهُ إِلَّا بِإِذْنِهِ يَعْلَمُ مَا بَيْنَ أَيْدِيهِمْ وَمَا خَلْفَهُمْ وَلَا يُحِيطُونَ بِشَيْءٍ مِنْ عِلْمِهِ إِلَّا بِمَا شَاءَ وَسِعَ كُرْسِيُّهُ السَّمَاوَاتِ وَالْأَرْضَ وَلاَ يَؤُودُهُ حِفْظُهُمَا وَهُوَ الْعَلِيُّ الْعَظِيمُ",
                    count: 1,
                    reference: "آية الكرسي - البقرة 255",
                    benefits: "مَنْ قالَها حِينَ يُمسِي أُجِيرَ من الجن حتَى يُصْبِحَ"
                },
                {
                    id: 3,
                    text: "بسم الله الرحمن الرحيم قُلۡ هُوَ ٱللَّهُ أَحَدٌ (1) ٱللَّهُ ٱلصَّمَدُ (2) لَمۡ يَلِدۡ وَلَمۡ يُولَدۡ (3) وَلَمۡ يَكُن لَّهُۥ كُفُوًا أَحَدُۢ (4)",
                    count: 3,
                    reference: "سورة الإخلاص",
                    benefits: "من قالها ثلاث مرات حين يصبح وحين يمسي كفته من كلِّ شيءٍ"
                },
                {
                    id: 4,
                    text: "بسم الله الرحمن الرحيم قُلۡ أَعُوذُ بِرَبِّ ٱلۡفَلَقِ (1) مِن شَرِّ مَا خَلَقَ (2) وَمِن شَرِّ غَاسِقٍ إِذَا وَقَبَ (3) وَمِن شَرِّ ٱلنَّفَّٰثَٰتِ فِي ٱلۡعُقَدِ (4) وَمِن شَرِّ حَاسِدٍ إِذَا حَسَدَ (5)",
                    count: 3,
                    reference: "سورة الفلق",
                    benefits: "من قالها ثلاث مرات حين يصبح وحين يمسي كفته من كلِّ شيءٍ"
                },
                {
                    id: 5,
                    text: "بسم الله الرحمن الرحيم قُلۡ أَعُوذُ بِرَبِّ ٱلنَّاسِ (1) مَلِكِ ٱلنَّاسِ (2) إِلَٰهِ ٱلنَّاسِ (3) مِن شَرِّ ٱلۡوَسۡوَاسِ ٱلۡخَنَّاسِ (4) ٱلَّذِي يُوَسۡوِسُ فِي صُدُورِ ٱلنَّاسِ (5) مِنَ ٱلۡجِنَّةِ وَٱلنَّاسِ (6)",
                    count: 3,
                    reference: "سورة الناس",
                    benefits: "من قالها ثلاث مرات حين يصبح وحين يمسي كفته من كلِّ شيءٍ"
                },
                {
                    id: 6,
                    text: "سُبْحَانَ اللَّهِ وَبِحَمْدِهِ",
                    count: 100,
                    reference: "البخاري ومسلم",
                    benefits: "حُطَّتْ خَطَايَاهُ وَإِنْ كَانَتْ مِثْلَ زَبَدِ الْبَحْرِ. لَمْ يَأْتِ أَحَدٌ يَوْمَ الْقِيَامَةِ بِأَفْضَلَ مِمَّا جَاءَ بِهِ إِلَّا أَحَدٌ قَالَ مِثْلَ مَا قَالَ أَوْ زَادَ عَلَيْهِ."
                },
                {
                    id: 7,
                    text: "أَمْسَيْـنا وَأَمْسـى المـلكُ لله وَالحَمدُ لله ، لا إلهَ إلاّ اللّهُ وَحدَهُ لا شَريكَ لهُ، لهُ المُـلكُ ولهُ الحَمْـد، وهُوَ على كلّ شَيءٍ قدير ، رَبِّ أسْـأَلُـكَ خَـيرَ ما في هـذهِ اللَّـيْلَةِ وَخَـيرَ ما بَعْـدَهـا ، وَأَعـوذُ بِكَ مِنْ شَـرِّ ما في هـذهِ اللَّـيْلةِ وَشَرِّ ما بَعْـدَهـا ، رَبِّ أَعـوذُ بِكَ مِنَ الْكَسَـلِ وَسـوءِ الْكِـبَر ، رَبِّ أَعـوذُ بِكَ مِنْ عَـذابٍ في النّـارِ وَعَـذابٍ في القَـبْر",
                    count: 1,
                    reference: "صحيح مسلم",
                    
                },
                {
                    id: 8,
                    text: "اللّهـمَّ أَنْتَ رَبِّـي لا إلهَ إلاّ أَنْتَ ، خَلَقْتَنـي وَأَنا عَبْـدُك ، وَأَنا عَلـى عَهْـدِكَ وَوَعْـدِكَ ما اسْتَـطَعْـت ، أَعـوذُ بِكَ مِنْ شَـرِّ ما صَنَـعْت ، أَبـوءُ لَـكَ بِنِعْـمَتِـكَ عَلَـيَّ وَأَبـوءُ بِذَنْـبي فَاغْفـِرْ لي فَإِنَّـهُ لا يَغْـفِرُ الذُّنـوبَ إِلاّ أَنْتَ",
                    count: 1,
                    reference: "البخاري",
                    benefits: "مَن قالَها مِنَ النَّهارِ مُوقِنًا بها، فَماتَ مِن يَومِهِ قَبْلَ أنْ يُمْسِيَ، فَهو مِن أهْلِ الجَنَّةِ، ومَن قالَها مِنَ اللَّيْلِ وهو مُوقِنٌ بها، فَماتَ قَبْلَ أنْ يُصْبِحَ، فَهو مِن أهْلِ الجَنَّةِ."
                },
                {
                    id: 9,
                    text: "اللّهُـمَّ بِكَ أَمْسَـينا وَبِكَ أَصْـبَحْنا ، وَبِكَ نَحْـيا وَبِكَ نَمُـوتُ وَإِلَـيْكَ الْمَصِيرُ",
                    count: 1,
                    reference: "الترمذي",
                },
                {
                    id: 10,
                    text: "اللّهُـمَّ عالِـمَ الغَـيْبِ وَالشّـهادَةِ فاطِـرَ السّماواتِ وَالأرْضِ رَبَّ كـلِّ شَـيءٍ وَمَليـكَه ، أَشْهَـدُ أَنْ لا إِلـهَ إِلاّ أَنْت ، أَعـوذُ بِكَ مِن شَـرِّ نَفْسـي وَمِن شَـرِّ الشَّيْـطانِ وَشِرْكِهِ ، وَأَنْ أَقْتَـرِفَ عَلـى نَفْسـي سوءاً أَوْ أَجُـرَّهُ إِلـى مُسْـلِم",
                    count: 1,
                    reference: "البخاري ومسلم",
                    benefits: "من قالها عَشْرَ مِرَارٍ كانَ كَمَن أَعْتَقَ أَرْبَعَةَ أَنْفُسٍ مِن وَلَدِ إسْمَاعِيلَ"
                },
                {
                    id: 11,
                    text: "بِسـمِ اللهِ الذي لا يَضُـرُّ مَعَ اسمِـهِ شَيءٌ في الأرْضِ وَلا في السّمـاءِ وَهـوَ السّمـيعُ العَلـيم",
                    count: 3,
                    reference: "صحيح أبي داود",
                    benefits: "من قالها ثلاثاً إذا أصبح, وثلاثاً إذا أمسى لم يضره شيء. "
                },
                {
                    id: 12,
                    text: "رَضيـتُ بِاللهِ رَبَّـاً وَبِالإسْلامِ ديـناً وَبِمُحَـمَّدٍ صلى الله عليه وسلم نَبِيّـاً",
                    count: 3,
                    reference: "الترمذي، وأبو داوود",
                    benefits: "من قالها ثلاثاً مرات حين يصبح وثلاثاً حين يمسي كان حقًا على الله أن يُرضِيَه"
                },
                {
                    id: 13,
                    text: "اللّهُـمَّ إِنِّـي أَصْبَـحْتُ أُشْـهِدُك ، وَأُشْـهِدُ حَمَلَـةَ عَـرْشِـك ، وَمَلَائِكَتَكَ ، وَجَمـيعَ خَلْـقِك ، أَنَّـكَ أَنْـتَ اللهُ لا إلهَ إلاّ أَنْـتَ وَحْـدَكَ لا شَريكَ لَـك ، وَأَنَّ  مُحَمّـداً عَبْـدُكَ وَرَسـولُـك",
                    count: 4,
                    reference: "أخرجه أبو داود",
                    benefits: "من قالها حين يصبح، أو يمسي أربعًا، أعتقَه اللهُ من النَّارِ  "
                },
                {
                    id: 14,
                    text: "اللّهُـمَّ ما أَمسى بي مِـنْ نِعْـمَةٍ أَو بِأَحَـدٍ مِـنْ خَلْـقِك ، فَمِـنْكَ وَحْـدَكَ لا شريكَ لَـك ، فَلَـكَ الْحَمْـدُ وَلَـكَ الشُّكْـر",
                    count: 1,
                    reference: "أخرجه أبو داود",
                    benefits: "مَن قالَ حينَ يُصبِحُ فقد أدَّى شُكرَ يومِه، ومن قالَ مثلَ ذلِك حينَ يُمسي، فقد أدَّى شُكرَ ليلتِه"
                },
                {
                    id: 15,
                    text: "اللّهُـمَّ إِنِّـي أسْـأَلُـكَ العَـفْوَ وَالعـافِـيةَ في الدُّنْـيا وَالآخِـرَة ، اللّهُـمَّ إِنِّـي أسْـأَلُـكَ العَـفْوَ وَالعـافِـيةَ في ديني وَدُنْـيايَ وَأهْـلي وَمالـي ، اللّهُـمَّ اسْتُـرْ عـوْراتي وَآمِـنْ رَوْعاتـي ، اللّهُـمَّ احْفَظْـني مِن بَـينِ يَدَيَّ وَمِن خَلْفـي وَعَن يَمـيني وَعَن شِمـالي ، وَمِن فَوْقـي ، وَأَعـوذُ بِعَظَمَـتِكَ أَن أُغْـتالَ مِن تَحْتـي",
                    count: 1,
                    reference: "أخرجه أبو داود",
                },
                {
                    id: 16,
                    text: "لَا إلَه إلّا اللهُ وَحْدَهُ لَا شَرِيكَ لَهُ، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ وَهُوَ عَلَى كُلِّ شَيْءِ قَدِيرٌ",
                    count: 10,
                    reference: "البخاري ومسلم",
                    benefits: "من قالها عَشْرَ مِرَارٍ كانَ كَمَن أَعْتَقَ أَرْبَعَةَ أَنْفُسٍ مِن وَلَدِ إسْمَاعِيلَ"
                },
                {
                    id: 17,
                    text: "أَعـوذُ بِكَلِمـاتِ اللّهِ التّـامّـاتِ مِنْ شَـرِّ ما خَلَـق",
                    count: 3,
                    reference: "أخرجه مسلم",
                    benefits: "من قالها حين يصبحُ ثلاثَ مراتٍ لم تضرهُ عقربٌ حتى يمسِي ، ومن قالها حينَ يمسي لم تضرُّه حتى يصبحَ "
                },
                {
                    id: 18,
                    text: "أَمْسَيْنَا عَلَى فِطْرَةِ الإسْلاَمِ، وَعَلَى كَلِمَةِ الإِخْلاَصِ ، وَعَلَى دِينِ نَبِيِّنَا مُحَمَّدٍ صَلَّى اللهُ عَلَيْهِ وَسَلَّمَ ، وَعَلَى مِلَّةِ أَبِينَا إبْرَاهِيمَ حَنِيفاً مُسْلِماً وَمَا كَانَ مِنَ المُشْرِكِينَ",
                    count: 1,
                    reference: "رواه أحمد",
                },
                {
                    id: 19,
                    text: "اللّهُـمَّ عافِـني في بَدَنـي ، اللّهُـمَّ عافِـني في سَمْـعي ، اللّهُـمَّ عافِـني في بَصَـري ، لا إلهَ إلاّ أَنْـتَ . اللّهُـمَّ إِنّـي أَعـوذُ بِكَ مِنَ الْكُـفر ، وَالفَـقْر ، وَأَعـوذُ بِكَ مِنْ عَذابِ القَـبْر ، لا إلهَ إلاّ أَنْـتَ",
                    count: 3,
                    reference: "صحيح أبي داود",
                },
                {
                    id: 20,
                    text: "لَا إلَه إلّا اللهُ وَحْدَهُ لَا شَرِيكَ لَهُ، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ وَهُوَ عَلَى كُلِّ شَيْءِ قَدِيرٌ",
                    count: 100,
                    reference: "البخاري ومسلم",
                    benefits: "كانت له عدل عشر رقاب، وكتبت له مئة حسنة، ومحيت عنه مئة سيئة"
                },
                {
                    id: 21,
                    text: "حَسْبِـيَ اللّهُ لا إلهَ إلاّ هُوَ عَلَـيهِ تَوَكَّـلتُ وَهُوَ رَبُّ العَرْشِ العَظـيم",
                    count: 7,
                    reference: "رواه ابن السني مرفوعاً وأبو داود موقوفاً",
                    benefits: "من قالها إذا أصبح وإذا أمسَى سبعَ مراتٍ كفاه اللهُ ما أهمَّه من أمر الدنيا والآخرة "
                },
                {
                    id: 22,
                    text: "يَا حَيُّ يَا قيُّومُ بِرَحْمَتِكَ أسْتَغِيثُ أصْلِحْ لِي شَأنِي كُلَّهُ وَلاَ تَكِلْنِي إلَى نَفْسِي طَـرْفَةَ عَيْنٍ",
                    count: 1,
                    reference: "صحيح الترغيب ",
                },
                {
                    id: 23,
                    text: "أَمْسَيْنا وَأَمْسَى الْمُلْكُ للهِ رَبِّ الْعَالَمَيْنِ ، اللَّهُمَّ إِنَّي أسْأَلُكَ خَيْرَ هَذَه اللَّيْلَةِ فَتْحَهَا ونَصْرَهَا ، ونُوْرَهَا وبَرَكَتهَا، وَهُدَاهَا ، وَأَعُوذُ بِكَ مِنْ شَرِّ مَا فيهِا وَشَرِّ مَا بَعْدَهَا",
                    count: 1,
                    reference: "أبو داود",
                },
                {
                    id: 24,
                    text: "سُبْحـانَ اللهِ وَبِحَمْـدِهِ عَدَدَ خَلْـقِه ، وَرِضـا نَفْسِـه ، وَزِنَـةَ عَـرْشِـه ، وَمِـدادَ كَلِمـاتِـه",
                    count: 3,
                    reference: "مسلم",
                },
                {
                    id: 25,
                    text: "أسْتَغْفِرُ اللهَ وَأتُوبُ إلَيْهِ",
                    count: 100,
                    reference: "البخاري ومسلم",
                },
                {
                    id: 26,
                    text: "اللَّهُمَّ صَلِّ وَسَلِّمْ وَبَارِكْ على نَبِيِّنَا مُحمَّد",
                    count: 10,
                    reference: " أخرجه الطبراني كما في ((الترغيب والترهيب))",
                    benefits: "من صلَّى عليَّ حينَ يصبحُ عشرًا وحينَ يمسي عشرًا أدرَكتْهُ شفاعتي يومَ القيامةِ"
                },
                    
            ]
        };

        // حالة التطبيق
        let state = {
            currentTab: 'morning',
            counts: {},
            completed: new Set(),
            lastVisit: null,
            streak: 0
        };

        // تهيئة التطبيق
        function init() {
            loadState();
            updateTime();
            renderAzkar();
            updateStats();
            setupEventListeners();
            checkReminders();

            // تحديث الوقت كل دقيقة
            setInterval(updateTime, 60000);
        }

        // تحديث الوقت
        function updateTime() {
            const now = new Date();
            const hours = now.getHours();
            const timeElement = document.getElementById('current-time');

            let greeting = '';
            if (hours >= 5 && hours < 12) {
                greeting = '🌅 صباح الخير';
                showTab('morning');
            } else if (hours >= 12 && hours < 18) {
                greeting = '🏙️ وقت الظهيرة';
                showTab('morning');
            } else {
                greeting = '🌆 مساء الخير';
                showTab('evening');
            }

            timeElement.textContent = greeting;
        }

        // عرض الأذكار
        function renderAzkar() {
            const container = document.getElementById('azkar-list');
            const azkar = azkarData[state.currentTab];

            container.innerHTML = '';

            azkar.forEach(zekr => {
                const currentCount = state.counts[zekr.id] || 0;
                const isCompleted = currentCount >= zekr.count;

                const card = document.createElement('div');
                card.className = `zekr-card ${isCompleted ? 'completed' : ''}`;
                card.innerHTML = `
                    <div class="zekr-text">${zekr.text}</div>

                    <div class="benefits">
                        <i class="fas fa-star"></i> ${zekr.benefits}
                    </div>

                    <div class="zekr-info">
                        <div class="reference">
                            <i class="fas fa-book"></i> ${zekr.reference}
                        </div>

                        <div class="counter">
                            <span class="target-count">العدد: ${zekr.count}</span>
                            <div class="count-display" id="count-${zekr.id}">${currentCount}</div>
                            <div class="count-controls">
                                <button class="count-btn plus" data-id="${zekr.id}">+</button>
                                <button class="count-btn minus" data-id="${zekr.id}">-</button>
                            </div>
                        </div>
                    </div>
                `;

                container.appendChild(card);
            });

            // إضافة مستمعي الأحداث للأزرار
            document.querySelectorAll('.count-btn.plus').forEach(btn => {
                btn.addEventListener('click', () => incrementCount(btn.dataset.id));
            });

            document.querySelectorAll('.count-btn.minus').forEach(btn => {
                btn.addEventListener('click', () => decrementCount(btn.dataset.id));
            });
        }

        // زيادة العداد
        function incrementCount(id) {
            const zekr = getCurrentZekr(id);
            if (!zekr) return;

            state.counts[id] = (state.counts[id] || 0) + 1;

            // إذا أكمل العدد
            if (state.counts[id] >= zekr.count) {
                state.completed.add(id);
                showNotification(`مبروك! أكملت ذكر "${zekr.text.substring(0, 30)}..."`);
            }

            updateDisplay(id);
            updateStats();
            saveState();
        }

        // تقليل العداد
        function decrementCount(id) {
            if (state.counts[id] && state.counts[id] > 0) {
                state.counts[id]--;
                state.completed.delete(id);
                updateDisplay(id);
                updateStats();
                saveState();
            }
        }

        // تحديث العرض
        function updateDisplay(id) {
            const display = document.getElementById(`count-${id}`);
            if (display) {
                display.textContent = state.counts[id] || 0;

                // تحديث حالة البطاقة
                const card = display.closest('.zekr-card');
                const zekr = getCurrentZekr(id);
                if (zekr && state.counts[id] >= zekr.count) {
                    card.classList.add('completed');
                } else {
                    card.classList.remove('completed');
                }
            }
        }

        // عرض التبويب
        function showTab(tabName) {
            state.currentTab = tabName;

            // تحديث أزرار التبويب
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.tab === tabName) {
                    btn.classList.add('active');
                }
            });

            renderAzkar();
            updateStats();
        }

        // تحديث الإحصائيات
        function updateStats() {
            const azkar = azkarData[state.currentTab];
            let total = 0;
            let completed = 0;

            azkar.forEach(zekr => {
                total += zekr.count;
                if (state.counts[zekr.id] >= zekr.count) {
                    completed++;
                }
            });

            document.getElementById('total-count').textContent =
                Object.values(state.counts).reduce((a, b) => a + b, 0);
            document.getElementById('completed-count').textContent = completed;
            document.getElementById('remaining-count').textContent = azkar.length - completed;
        }

        // التذكير
        function checkReminders() {
            const now = new Date();
            const hours = now.getHours();
            const reminder = document.getElementById('reminder-text');

            if (hours >= 5 && hours < 12) {
                reminder.textContent = '🌅 حان وقت أذكار الصباح! ابدأ يومك بذكر الله';
            } else if (hours >= 17 && hours < 20) {
                reminder.textContent = '🌆 حان وقت أذكار المساء! احفظ نفسك بذكر الله';
            }
        }

        // الإشعارات
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.display = 'block';

            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // الحفظ والتحميل
        function saveState() {
            localStorage.setItem('azkarAppState', JSON.stringify(state));
        }

        function loadState() {
            const saved = localStorage.getItem('azkarAppState');
            if (saved) {
                state = JSON.parse(saved);

                // التحقق من تاريخ آخر زيارة
                const today = new Date().toDateString();
                if (state.lastVisit !== today) {
                    // إعادة تعيين العدادات لليوم الجديد
                    state.counts = {};
                    state.completed = new Set();
                    state.lastVisit = today;

                    // زيادة المتتالية إذا زار أمس
                    const yesterday = new Date();
                    yesterday.setDate(yesterday.getDate() - 1);
                    if (state.lastVisit === yesterday.toDateString()) {
                        state.streak++;
                    }
                }
            }

            // تحويل completed من Array إلى Set إذا لزم
            if (Array.isArray(state.completed)) {
                state.completed = new Set(state.completed);
            }
        }

        // مساعدة
        function getCurrentZekr(id) {
            return azkarData[state.currentTab].find(z => z.id == id);
        }

        // إعداد مستمعي الأحداث
        function setupEventListeners() {
            // أزرار التبويب
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => showTab(btn.dataset.tab));
            });

            // زر المشاركة
            document.getElementById('share-app').addEventListener('click', () => {
                if (navigator.share) {
                    navigator.share({
                        title: 'تطبيق أذكار الصباح والمساء',
                        text: 'جرب هذا التطبيق المفيد للأذكار اليومية',
                        url: window.location.href
                    });
                } else {
                    showNotification('انسخ الرابط وشاركه مع الآخرين: ' + window.location.href);
                }
            });

            // زر الطباعة
            document.getElementById('print-btn').addEventListener('click', () => {
                window.print();
            });

            // زر التنزيل
            document.getElementById('download-btn').addEventListener('click', () => {
                const dataStr = JSON.stringify(state, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                const link = document.createElement('a');
                link.setAttribute('href', dataUri);
                link.setAttribute('download', 'azkar-progress.json');
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                showNotification('تم حفظ تقدمك بنجاح!');
            });

            // اختصارات لوحة المفاتيح
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowRight') {
                    showTab('morning');
                } else if (e.key === 'ArrowLeft') {
                    showTab('evening');
                } else if (e.key === ' ') {
                    const firstUncompleted = azkarData[state.currentTab].find(z =>
                        !state.completed.has(z.id)
                    );
                    if (firstUncompleted) {
                        incrementCount(firstUncompleted.id);
                    }
                }
            });
        }

        // بدء التطبيق
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>